webpackJsonp([2],Array(26).concat([function(e,t,n){"use strict";var i=n(15),r=n(98),o=n(83),a=n.n(o);i.a.use(r.a),t.a=new r.a({routes:[{path:"/",name:"Editor",component:a.a}]})},function(e,t,n){function i(e){n(76)}var r=n(0)(n(30),n(96),i,null,null);e.exports=r.exports},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),r=n(27),o=n.n(r),a=n(26);i.a.config.productionTip=!1,new i.a({el:"#app",router:a.a,template:"<App/>",components:{App:o.a}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(82),r=n.n(i),o=n(84),a=n.n(o),s=n(86),c=n.n(s);t.default={name:"Annotator",components:{AreaSelect:r.a,PDF:a.a,SelectionPreview:c.a},props:["src","name","selections","addSelection","arrayBuffer","setPdfSize"],data:function(){return{down:!1,coords:{xa:null,ya:null,xb:null,yb:null},pageNumber:1,pageOffset:{top:0,left:0}}},computed:{coordinates:function(){return{left:Math.min(this.coords.xa,this.coords.xb),top:Math.min(this.coords.ya,this.coords.yb),width:Math.abs(this.coords.xa-this.coords.xb),height:Math.abs(this.coords.ya-this.coords.yb),page:this.pageNumber,pageOffset:{top:this.pageOffset.top,left:this.pageOffset.left}}}},methods:{reset:function(){this.coords.xa=null,this.coords.ya=null,this.coords.xb=null,this.coords.yb=null},start:function(e){this.down=!0,this.pageNumber=parseInt(e.target.getAttribute("data-page-number")||1),this.pageOffset.top=e.target.offsetTop,this.pageOffset.left=e.target.offsetLeft,this.coords.xa=e.offsetX,this.coords.ya=e.offsetY,this.coords.xb=e.offsetX,this.coords.yb=e.offsetY},end:function(e){e.stopPropagation(),e.preventDefault(),this.down=!1,this.addSelection(this.coordinates),this.reset()},drag:function(e){e.stopPropagation(),e.preventDefault(),this.down&&(this.coords.xb=e.offsetX,this.coords.yb=e.offsetY)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"area-select",props:["coordinates","color","name","active"],computed:{styleObject:function(){return 0===this.height||0===this.width?{display:"none"}:{left:this.coordinates.left+this.coordinates.pageOffset.left+"px",top:this.coordinates.top+this.coordinates.pageOffset.top+"px",width:this.coordinates.width+"px",height:this.coordinates.height+"px",border:"solid "+this.color+" 1px",background:this.color.replace(/\)$/,", 0.05)").replace("rgb(","rgba(")}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(87),r=n.n(i),o=n(81),a=n.n(o),s=n(88),c=n.n(s),l=n(85),u=n.n(l),d=n(80),f=n.n(d);t.default={name:"editor",components:{Uploader:r.a,Annotator:a.a,ZoneViewer:c.a,PDFZoneViewer:u.a},data:function(){return{src:null,arrayBuffer:null,name:"",selections:[],pdfDimensions:{height:0,width:0}}},methods:{batchUpdateSelections:function(e){this.selections=e},setPdfSize:function(e,t){this.pdfDimensions={width:e,height:t}},addSelection:function(e){0!==e.height&&0!==e.width&&this.selections.push({id:+new Date,coordinates:{top:e.top,left:e.left,height:e.height,width:e.width,page:e.page,pageOffset:e.pageOffset},color:f()({format:"rgb"}),name:"Unnamed"+this.selections.length})},newFile:function(e){this.name=e.name,this.src=e.src,this.arrayBuffer=e.arrayBuffer,this.selections=[]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(78),r=n.n(i),o=n(79);o.PDFViewer=r.a.PDFJS.PDFViewer,t.default={props:["arrayBuffer","setPdfSize"],data:function(){return{width:null}},computed:{styleObject:function(){return{width:this.width?this.width+"px":"auto"}}},watch:{arrayBuffer:function(){this.loadDocument()}},methods:{loadDocument:function(){var e=this;console.log("new document"),o.getDocument(this.arrayBuffer).then(function(t){t.getPage(1).then(function(n){var i=n.getViewport(1);e.setPdfSize(i.width,i.height),e.width=i.width,e.pdfViewer.setDocument(t).then(function(){window.scrollTo(0,0)})})})}},mounted:function(){var e=this,t=this.$refs["pdf-container"];this.pdfViewer=new o.PDFViewer({container:t}),t.addEventListener("pagesinit",function(){e.pdfViewer.currentScaleValue="page-width"}),this.loadDocument()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["selections","batchUpdateSelections","originalFilename","dimensions"],data:function(){return{uzn:null,editing:!1}},computed:{downloadable:function(){var e=new Blob([this.uzn],{type:"octet/stream"});return window.URL.createObjectURL(e)},filename:function(){return this.originalFilename.replace(/(.*)\..*/,"$1.uzn")}},mounted:function(){this.redrawUzn()},watch:{selections:function(){this.redrawUzn()}},methods:{startEditing:function(){this.editing=!0},stopEditing:function(){this.editing=!1,this.redrawUzn()},redrawUzn:function(){var e=this;if(!this.editing){if(0===this.selections.length)return void(this.uzn="");var t=this.selections.map(function(t){var n=parseInt(e.dimensions.height-t.coordinates.top),i=parseInt(e.dimensions.height-t.coordinates.top-t.coordinates.height),r=[t.coordinates.left,Math.min(n,i),t.coordinates.left+t.coordinates.width,Math.max(n,i)].join(","),o="LTPage[pageid=\\'"+t.coordinates.page+"\\'] LTTextLineHorizontal:overlaps_bbox(\""+r+'")';return"\t('"+t.name+"', '"+o+"')"}),n=t.join(",\n");this.uzn="pdf = pdfquery.PDFQuery('"+this.originalFilename+"')\n\npdf.extract([\n\t('with_formatter', 'text'),\n"+n+"\n])"}},changed:function(e){var t=this;console.log("CHANGED");var n=0,i=this.uzn.split("\n").map(function(e){var i=e.match(/\('(.*)',.*pageid=\\'(\d+)\\'.*bbox\("(\d+),(\d+),(\d+),(\d+)"\)/);try{var r=t.selections[n];return r.coordinates.left=parseInt(i[3]),r.coordinates.top=t.dimensions.height-parseInt(i[4]),r.coordinates.width=parseInt(i[5])-parseInt(i[3]),r.coordinates.height=Math.abs(parseInt(i[6])-parseInt(i[4])),r.name=i[1],r.page=i[2],n++,r}catch(e){return console.log(e),null}}).filter(function(e){return null!=e});this.batchUpdateSelections(i)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),r=n.n(i);t.default={props:["coordinates"],data:function(){return{text:null}},computed:{},watch:{coordinates:function(){this.highlightOverlaps()}},methods:{hasCoordinates:function(){var e=this.coordinates;return!!(e&&e.top&&e.left&&0!==e.height&&0!==e.width)},overlapping:function(){if(this.hasCoordinates()){var e=document.querySelectorAll('.page[data-page-number="1"] .textLayer div');return Array.prototype.filter.call(e,this._overlaps)}return[]},overlappingText:function(){return this.overlapping().map(function(e){return e.textContent}).join(" ")},highlightOverlaps:function(){this.unhighlight(),this.overlapping().forEach(this._highlight)},_highlight:function(e){-1===e.className.indexOf("selected-preview")&&(e.className+=" selected-preview")},unhighlight:function(e){var t=document.querySelectorAll(".selected-preview"),n=!0,i=!1,o=void 0;try{for(var a,s=r()(t);!(n=(a=s.next()).done);n=!0){var c=a.value;c.className=c.className.replace("selected-preview","")}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}},_overlaps:function(e){var t=this.coordinates;return!(e.offsetLeft>t.left+t.width||e.offsetLeft+e.offsetWidth<t.left)&&!(e.offsetTop>t.top+t.height||t.top>e.offsetTop+e.offsetHeight)},_sorted:function(e,t){return e.offsetTop===t.offsetTop?e.offsetLeft<t.offsetTop?-1:1:e.offsetTop<t.offsetTop?-1:1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{notify:{type:Function,require:!0}},data:function(){return{name:null}},methods:{processReaderImage:function(e){this.notify({name:this.name,src:e.target.result})},processReaderPDF:function(e){this.notify({name:this.name,arrayBuffer:e.target.result})},getFile:function(e){var t=e[0];if(this.name=t.name,t.type.match("image.*")){var n=new FileReader;n.addEventListener("load",this.processReaderImage,!1),n.readAsDataURL(t)}else if(t.type.match(".*pdf.*")){var i=new FileReader;i.addEventListener("load",this.processReaderPDF,!1),i.readAsArrayBuffer(t)}else alert("Not a PDF or image file")},selected:function(e){this.getFile(e.target.files)},drop:function(e){e.stopPropagation(),e.preventDefault(),this.getFile(e.dataTransfer.files)},dragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"zone-viewer",props:["selections","batchUpdateSelections","originalFilename"],data:function(){return{uzn:null,editing:!1}},computed:{downloadable:function(){var e=new Blob([this.uzn],{type:"octet/stream"});return window.URL.createObjectURL(e)},filename:function(){return this.originalFilename.replace(/(.*)\..*/,"$1.uzn")}},mounted:function(){this.redrawUzn()},watch:{selections:function(){this.redrawUzn()}},methods:{startEditing:function(){this.editing=!0},stopEditing:function(){this.editing=!1,this.redrawUzn()},redrawUzn:function(){if(!this.editing){var e=this.selections.map(function(e){return e.coordinates.left+" "+e.coordinates.top+" "+e.coordinates.width+" "+e.coordinates.height+" "+e.name});this.uzn=e.join("\n")}},changed:function(e){var t=this,n=this.uzn.split("\n").map(function(e,n){try{var i=e.match(/(\d+) (\d+) (\d+) (\d+) (.*)/),r=t.selections[n];return r.coordinates.left=parseInt(i[1]),r.coordinates.top=parseInt(i[2]),r.coordinates.width=parseInt(i[3]),r.coordinates.height=parseInt(i[4]),r.name=i[5],r}catch(e){return null}}).filter(function(e){return null!=e});console.log("updating with",n),this.batchUpdateSelections(n)}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,function(e,t,n){function i(e){n(75)}var r=n(0)(n(31),n(95),i,"data-v-557e482b",null);e.exports=r.exports},function(e,t,n){function i(e){n(72)}var r=n(0)(n(32),n(92),i,"data-v-1849b72a",null);e.exports=r.exports},function(e,t,n){function i(e){n(77)}var r=n(0)(n(33),n(97),i,null,null);e.exports=r.exports},function(e,t,n){function i(e){n(70)}var r=n(0)(n(34),n(90),i,null,null);e.exports=r.exports},function(e,t,n){function i(e){n(74)}var r=n(0)(n(35),n(94),i,"data-v-3b727782",null);e.exports=r.exports},function(e,t,n){function i(e){n(73)}var r=n(0)(n(36),n(93),i,null,null);e.exports=r.exports},function(e,t,n){function i(e){n(69)}var r=n(0)(n(37),n(89),i,"data-v-0043a522",null);e.exports=r.exports},function(e,t,n){function i(e){n(71)}var r=n(0)(n(38),n(91),i,null,null);e.exports=r.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"dragover"},on:{dragover:e.dragover,drop:e.drop}},[n("h3",[e._v("Drag & drop your file here")]),e._v(" "),e._m(0),e._v(" "),n("p",[e._v("accepts images and PDFs")]),e._v(" "),n("input",{attrs:{type:"file",id:"file",name:"file"},on:{change:e.selected}})])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("or "),n("label",{attrs:{for:"file"}},[e._v("click to browse")])])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"pdf-container",staticClass:"pdf-container",style:e.styleObject},[n("div",{staticClass:"pdfViewer"})])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.selections.length>0?n("div",{staticClass:"zone-viewer"},[n("h2",[e._v("Your zone file")]),e._v(" "),e._m(0),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.uzn,expression:"uzn"}],ref:"textarea",domProps:{value:e.uzn},on:{keyup:e.changed,blur:e.stopEditing,focus:e.startEditing,input:function(t){t.target.composing||(e.uzn=t.target.value)}}}),e._v(" "),n("a",{attrs:{href:e.downloadable,download:e.filename}},[e._v("Download .uzn file")])]):e._e()},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Edit the code below")]),e._v(" and it'll update on the right!")])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"selection-box",style:e.styleObject},[n("span",[e._v(e._s(e.name))])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"preview"},[e._v("\n"+e._s(e.text)+"\n")])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.selections.length>0?n("div",{staticClass:"pdf-zone-viewer"},[n("h2",[e._v("Your extraction code")]),e._v(" "),e._m(0),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.uzn,expression:"uzn"}],ref:"textarea",domProps:{value:e.uzn},on:{keyup:e.changed,blur:e.stopEditing,focus:e.startEditing,input:function(t){t.target.composing||(e.uzn=t.target.value)}}}),e._v(" "),e._m(1)]):e._e()},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Edit the variable names and numbers below")]),e._v(" and you'll see it update to the right!")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("This code uses "),n("a",{attrs:{href:"https://github.com/jcushman/pdfquery",target:"_blank"}},[e._v("pdfquery")]),e._v(". You can just cut and paste if you want, but if you read the documentation it'll save you a lot of time.")])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.name?n("h3",[e._v("\n    Currently working on: "),n("span",{staticClass:"filename"},[e._v(e._s(e.name))]),e._v(" "),n("span",{staticClass:"filetype"},[e._v(e._s(e.arrayBuffer?"PDF":"image"))])]):e._e(),e._v(" "),e.src||e.arrayBuffer?n("div",{ref:"selectionArea",staticClass:"selection-area",on:{mousedown:e.start,mouseup:e.end,mousemove:e.drag}},[e.src?n("img",{attrs:{src:e.src}}):e._e(),e._v(" "),e.arrayBuffer?n("PDF",{attrs:{setPdfSize:e.setPdfSize,arrayBuffer:e.arrayBuffer}}):e._e(),e._v(" "),e.arrayBuffer?n("SelectionPreview",{attrs:{coordinates:e.coordinates}}):e._e(),e._v(" "),n("AreaSelect",{ref:"activeSelector",attrs:{coordinates:e.coordinates,color:"rgb(0,255,0)",active:"true"}}),e._v(" "),e._l(e.selections,function(e){return n("AreaSelect",{key:e.id,attrs:{color:e.color,coordinates:e.coordinates,name:e.name}})})],2):e._e()])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor"},[n("div",{staticClass:"sidebar"},[n("h1",[e._v("Kull")]),e._v(" "),e._m(0),e._v(" "),e._m(1),e._v(" "),n("Uploader",{attrs:{notify:e.newFile}}),e._v(" "),e.name?n("p",[n("strong",[e._v("Click and drag on the image to the right")]),e._v(" to form selection areas.")]):e._e(),e._v(" "),e.src?n("ZoneViewer",{staticClass:"zone-viewer",attrs:{selections:e.selections,batchUpdateSelections:e.batchUpdateSelections,originalFilename:e.name}}):e._e(),e._v(" "),e.arrayBuffer?n("PDFZoneViewer",{staticClass:"zone-viewer",attrs:{dimensions:e.pdfDimensions,selections:e.selections,batchUpdateSelections:e.batchUpdateSelections,originalFilename:e.name}}):e._e()],1),e._v(" "),n("div",{staticClass:"content"},[n("Annotator",{attrs:{src:e.src,setPdfSize:e.setPdfSize,arrayBuffer:e.arrayBuffer,name:e.name,selections:e.selections,addSelection:e.addSelection}})],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("A tool to interactively select text regions of PDFs and images.")]),e._v(" Use with "),n("a",{attrs:{href:"https://github.com/jcushman/pdfquery"}},[e._v("PDFQuery")]),e._v(" (Python/PDF) or to make UZN/OCR zone files for "),n("a",{attrs:{href:"https://github.com/tesseract-ocr/tesseract"}},[e._v("tesseract")]),e._v(" (image-to-text).")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("More details (maybe) at "),n("a",{attrs:{href:"https://github.com/jsoma/kull"}},[e._v("https://github.com/jsoma/kull")]),e._v(".")])}]}}]),[29]);
//# sourceMappingURL=app.3773e707aae855709ecf.js.map